\chapter{Introduction}\label{chp:1}

This thesis is the  main  result  of  a  research  and  development  agreement  between  the  French Agency for Food, Environmental and Occupational Health and Safety (ANSES\footnote{Agence nationale de sécurité sanitaire de l'alimentation, de l'environnement et du travail}) and the laboratory SAMM\footnote{Statistique, Analyse et Modélisation Multidisciplinaire} of the University Paris 1 Pantheon-Sorbonne.  One of the main tasks of ANSES is to monitor environmental data and provide tools which ensure the protection of the public and the environment.  In particular, national health authorities are very interested in monitoring and quantifying the concentration of various pollutants in specific environmental areas, as nowadays significant adverse health effects are well documented (\cite{khopkar2007,Marchant2018,NOUGADERE201432} for example). Within the Agency, the Phytopharmacovigilance Unit (UPPV) is entrusted with this task.  Indeed, the role of this unit is to establish a list of pollutants that must be monitored according to their potential harmful effects on the environment and health, and ultimately to issue recommendations for their use, in terms of dosage, duration and precautions of use. To achieve this goal, UPPV leads the national network of phytopharmacovigilance, which monitors environmental concentrations of phytopharmaceutical products.

Over the years, considerable efforts have been made at national level to build up public databases storing relevant information such as phytopharmaceutical product concentrations in surface waters \citep{Naiade} and hydrographic characteristics of French rivers \citep{IGN:BD:TOPO}. As a result, a considerable amount of data is now available that has not yet been fully exploited. Indeed UPPV now aims to  make  better  use  of  these  databases  by  defining  new  algorithms  and  statistical methods  to  achieve  better  pollution  monitoring.  The objective  is  to  help  experts summarise and  analyse  information  from  field  measurements, evaluate  these  measurements, detect possible  anomalies and issue  warnings if necessary. An example of such a tool  could be, for example, a monitoring system designed to detect patterns  such  as  fluctuations,  trends  or changes in relevant series of environmental measurements over time and space \citep{Manly2008}. \\

The work accomplished during this thesis takes place in this context, all the discussions and developments presented in this manuscript have been carried out in close cooperation with the experts of UPPV in order to address the objective mentioned above, more precisely the development of a method to detect changes and anomalous episodes in environmental measurements over time and space, as well as their numerical implementation.

Environmental concentrations of phytopharmaceutical products are collected through a network of measuring stations distributed over the entire French territory.  Modelling these data is a complex issue for several reasons. First of all, their monitoring involves the use of sensors at different sites that take samples at different times, so that the data collected contain spatio-temporal information. Other difficulties are related to the characteristics of the data collected, which may in part come from limitations in the measurement process. For instance: 
\begin{itemize}
\item Pollutant concentrations are measured with sensors, that usually have detection and quantification limits: The corresponding data are then left-censored.
\item The data distribution in itself is usually skewed to the right, with long tails indicating the  possible occurrence of high concentrations.
\item In many situations, data are collected irregularly due to measurement practises (measurements require human intervention).
\item Pollution is monitored at different locations, and different sensors may be used at each location, resulting in significant spatial heterogeneity.
\end{itemize}


%sensors usually have detection and quantification limits:  the corresponding data are then left-censored.  Sensors in different locations may have different technical characteristics which results in a significant spatial heterogeneity. In many situations, measurements require human intervention so that measurement practices induce a highly irregular time pattern of data collection.  Lastly, the data distribution in itself is usually skewed to the right, with long tails indicating  the  possible occurrences of high concentrations. 

This thesis proposes a new approach for dealing with spatio-temporal data that exhibit these characteristics. It requires a procedure that combines different models and methods. The basic principle is to use data sets that are as coherent as possible to find time periods and spatial zones where the information is as homogeneous as possible. Once these  moments  and  these  zones  are identified, we try to identify the most anomalous zones in these time periods. 

%This thesis is the main result of a research and development agreement between the French Agency for Food, Environmental and Occupational Health and Safety (ANSES\footnote{Agence nationale de sécurité sanitaire de l'alimentation, de l'environnement et du travail}) and the laboratory SAMM\footnote{Statistique, Analyse et Modélisation Multidisciplinaire} of the University Paris 1 Panthéon-Sorbonne. One of the main tasks of ANSES is to monitor environmental data and provide tools which ensure the protection of the public and the environment.

%In particular, national health authorities are very interested in monitoring and quantifying the concentration of various pollutants in specific environmental areas, as nowadays significant adverse health effects are well documented (\cite{khopkar2007,Marchant2018,NOUGADERE201432} for example). 

%Within the Agency, the Phytopharmacovigilance Unit (UPPV) is entrusted with this task. This unit collects and monitors the concentrations of phytopharmaceuticals products. Therefore, all discussions and work were carried out in close cooperation with the experts of this unit. These data are collected in measuring stations distributed over the entire French territory. Indeed, the monitoring of pollutants in the environment involves the use of sensors at different sites that take samples at different times. Therefore, the data collected is spatio-temporal information. 

%Therefore, all discussions and work were carried out in close cooperation with the experts of the Unit for Phytopharmacovigilance (UPPV). 
%Specifically, this thesis is concerned with concentration measurements in surface waters of a substance commonly used in France: Prosulfocarb. It is a herbicide used to protect wheat and barley from weeds. However, its presence in water bodies can be toxic to aquatic fauna. 

%Modelling such data is a complex issue. There are several reasons for this, some of which are related to the characteristics of the data collected, and some of which are related to the data collection procedure used in different countries.
%Let us look at some of these features:
%\begin{itemize}
%\item Pollutant concentrations are measured by sensors, which usually have detection and quantification limits: The corresponding data are then left-censored.
%\item The data distribution is usually skewed to the right, with long tails indicating the occurence of high concentrations.
%\item In many situations, data are collected irregularly due to measurement practises (measurements require human intervention).
%\item Pollution is monitored at different locations, and different sensors may be used at each location, resulting in significant spatial heterogeneity.
%\end{itemize}

%All the information measured results in a considerable amount of data. Efforts have been made at national level to build public databases storing all this information is stored. UPPV now aims to make better use of these databases by defining new algorithms and statistical methods to achieve better pollution monitoring. The aim is to help experts to summarise and analyse information from field measurements, to evaluate these measurements, to detect possible anomalies and to issue warnings if necessary. An example of such a tool could be, for example, a monitoring system designed to detect patterns such as fluctuations, trends or changes in relevant series of environmental measurements over time and space \citep{Manly2008}.

%This thesis proposes a new approach for dealing with time series that exhibit these characteristics. It requires a procedure that combines different models and methods. The basic principle is to find time periods and spatial zones where the information is as homogeneous as possible, using data sets that are as coherent as possible. Once these moments and these zones are identified, we try to identify the most anomalous zones in these time periods. 

%Let us summarise in more detail the procedure we are defining, which is the main contribution of our work.

%First, we define a change-point detection method to model the temporal heterogeneity by assuming, for a given temporal resolution, a piecewise stationary distribution of the series of concentration values. 

%Clustering is then used to model expected spatial homogeneity, taking into account geographical constraints such as river networks, wind directions, etc. 

%Depending on the temporal segment detected by the change-point procedure and the spatial cluster formed by the clustering procedure, we can finally analyse the data and identify contextual anomalies. Anomalies are then identified using multi-criteria decision analysis.

The manuscript is organized as follows:
\begin{itemize}
\item{\textbf{Chapter \ref{chp:2}}} is a presentation of the French national agency in charge of monitoring pollution data. A short description of the agency and of its missions are given with an extensive description of the available data derived from different sources of information that are useful for the analysis of environmental pollution. The last section presents a first example based on visualization techniques that allows to extract information from these data sets.
\item{\textbf{Chapter \ref{chp:3}}} makes an inventory of change-point detection methods. Since extensive reviews on change-point detection methods already exist, we only focus on some specific elements that could be useful when applying such methods to environmental data. We cover the case where the number of changes is unknown. We provide search methods (or heuristics) that give an optimal solution to that problem. The last section discusses applications of change-point methods in environmental data that were previously published in the literature.
\item{\textbf{In Chapter \ref{chp:4}}} we build a specific parametric change-point detection method. Our contribution consists in defining an adapted method for the problems we are facing. More precisely, we study the effect of censorship on the change-point detection. Then, we discuss different optimization strategies to estimate the parameters of the model. We define an iterative procedure to estimate at the same time piece-wise constant parameters and stationary parameters over time. Simulation experiments are led to compare the proposed method with a non parametric method that is also adapted to censored data.
\item{\textbf{Chapter \ref{chp:5}}} provides the case study of prosulfocarb concentrations in the Centre-Val de Loire French region. Both temporal and spatial analysis are made on this dataset. It uses the results of the change-point detection method developed in Chapter \ref{chp:4} on for the temporal dimension. 
The spatial heterogeneity is handled using classical clustering methods. We manage to extract some useful information from the resulting geographical areas and time periods by adding a final anomaly detection step. Our contribution results in the definition of a method which deals with rough data to finally provide alert about potential anomalies. 
\item{\textbf{Chapter \ref{chp:6}}} describes the development of an interactive application implemented in Rshiny that displays the results of the procedure defined in Chapter \ref{chp:5}. This application is illustrated by the prosulfocarb dataset. Since the results of Chapter \ref{chp:5} are presented in a static way (e.g. using Figures), first of all we can only present the results for a single detected time segment. So the application allows to store the results for all the time segments detected and to explore them interactively. This application serves an operational purpose. It is specifically designed for the experts working in that area of expertise
\end{itemize}

{\Large\textbf{Contributions}}
\begin{itemize}
\item \textbf{Article:} \\ 
\bibentry{Laroche2022} \\
\item \textbf{Conferences:} \\
\bibentry{JdS} \\
\bibentry{ICOR}
\item \texttt{Rshiny} \textbf{application:} \\
\url{https://github.com/Clement-Laroche/Application_ANSES}
\end{itemize}
